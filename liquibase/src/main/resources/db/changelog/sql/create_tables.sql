
CREATE TABLE client (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    personal_discount1 INTEGER DEFAULT 0,
    personal_discount2 INTEGER DEFAULT 0
);

CREATE TABLE product (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description VARCHAR(1000) NOT NULL,
    price INTEGER NOT NULL,
    discount INTEGER DEFAULT 0
);

CREATE TABLE cheque (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    number VARCHAR(5) NOT NULL,
    total_price INTEGER DEFAULT 0,
    client_id BIGINT REFERENCES client(id) ON DELETE RESTRICT,
    date TIMESTAMP WITHOUT TIME ZONE NOT NULL
);

CREATE TABLE shopping_list (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    cheque_id BIGINT REFERENCES cheque(id) ON DELETE RESTRICT,
    product_id BIGINT REFERENCES product(id) ON DELETE RESTRICT,
    client_id BIGINT REFERENCES client(id) ON DELETE RESTRICT,
    quantity INTEGER DEFAULT 0,
    price INTEGER DEFAULT 0,
    total_discount INTEGER DEFAULT 0,
    total_price INTEGER DEFAULT 0
);

CREATE TABLE reviews (
    client_id BIGINT REFERENCES client(id) ON DELETE RESTRICT,
    product_id BIGINT REFERENCES product(id) ON DELETE RESTRICT,
    rating INTEGER DEFAULT 5,
    CONSTRAINT uq_request UNIQUE (client_id, product_id)
);